<!DOCTYPE html>
<head>
	<link rel="icon" href="ico.png">
	<script src="defs.js"></script>
	<script src="Maze.js"></script>
	<script src="Player.js"></script>
	<script src="Draw.js"></script>
	<script defer>
	var m = Maze.random(32,20);

	var p = new Player(m);

	document.addEventListener('keydown', e => {
		if (e.key.includes('Arrow')) {
			e.preventDefault();
			p.move(VEC[e.key.substring(5).toUpperCase()]);
		}
		else if (e.key == 'r')
			p = new Player(m);

		// Player wins!
		if (m[p.x][p.y] == TILE.PLAID && p.x != 0) {
			stopTimer();
		}

		drawMaze(m);
		drawPlayer(p);
		drawState(p.state, p.score);
	});

	window.addEventListener('load', e => {
		let btn_rules = document.getElementById('btn_rules');
		let rules = document.getElementById('rules');
		btn_rules.addEventListener('mouseover', e => rules.style.display = 'block' );
		btn_rules.addEventListener('mouseleave', e => rules.style.display = 'none' );

		drawMaze(m);
		drawPlayer(p);
		drawState(p.state, p.score);
		drawTimer();
	});
	</script>
	<link rel="stylesheet" href="rainmaze.css">
</head>
<body>
	<div class="overlay" id="rules">
		EACH COLOR HAS A DIFFERENT FUNCTION!<br>
		RED TILES ARE IMPASSABLE!<br>
		YOU CANNOT WALK ON THEM!<br>
		YELLOW TILES ARE ELECTRIC!<br>
		THEY WILL ELECTROCUTE YOU!<br>
		GREEN TILES ARE ALARM TILES!<br>
		IF YOU STEP ON THEM...<br>
		<del>YOU WILL HAVE TO FIGHT A MONSTER!</del><br>
		A STROKE WILL BE ADDED TO YOUR SCORE.<br>
		LIKE GOLF!<br>
		ORANGE TILES ARE ORANGE-SCENTED.<br>
		THEY WILL MAKE YOU SMELL DELICIOUS!<br>
		BLUE TILES ARE WATER TILES.<br>
		SWIM THROUGH IF YOU LIKE, BUT...<br>
		IF YOU SMELL LIKE ORANGES!<br>
		THE PIRAHNAS WILL BITE YOU.<br>
		ALSO, IF A BLUE TILE IS NEXT TO A YELLOW TILE,<br>
		THE WATER WILL ALSO ZAP YOU!<br>
		PURPLE TILES ARE SLIPPERY!<br>
		YOU WILL SLIDE TO THE NEXT TILE!<br>
		HOWEVER, THE SLIPPERY SOAP...<br>
		SMELLS LIKE LEMONS!!<br>
		WHICH PIRAHNAS DO NOT LIKE!<br>
		PURPLE AND BLUE ARE OK!<br>
		FINALLY, PINK TILES.<br>
		THEY DON'T DO ANYTHING.<br>
		STEP ON THEM ALL YOU LIKE.<br>
	</div>
	<div>
		<button type="button" id="btn_rules">RULES</button>
		<canvas width="495" height="126" id="statusbar">Error displaying status bar!</canvas>
	</div>
	<canvas width="1" height="1" id="canvas">Error displaying canvas!</canvas>
	<p style="font-family: 'UTPapyrus'">
	</p>
</body>
